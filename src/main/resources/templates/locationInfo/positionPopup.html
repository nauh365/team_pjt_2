<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>위치 검색 허용</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link href="/css/popup.css" rel="stylesheet">
</head>
<body>
<h1>현재 위치 기준으로 검색하시겠습니까?</h1>
<button onclick="agreeToSearch()">예</button>
<button onclick="window.close()">아니오</button>
<button onclick="test()">test</button>

<!-- 로딩 마크업 -->
<div id="loading"
     style="display:none; position:absolute; top:0; left:0; right:0; bottom:0; background-color:rgba(255,255,255,0.8); z-index:9999;">
  <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
    <img src="/img/loading.gif" alt="Loading..."/>
  </div>
</div>

<script>
    function agreeToSearch() {
                console.log("여기는 agreeToSearch")
        navigator.geolocation.getCurrentPosition(function(position) {
            if (window.opener && !window.opener.closed) {
                document.getElementById('loading').style.display = 'block';
                window.opener.sendPositionToServer(position);
            }
            window.close();
        }, function(error) {
            console.error('위치 정보를 가져오는 데 실패했습니다.', error);
            window.close();
        });
    }

    function test() {
        console.log("여기는 test")
    }
</script>
</body>
</html>