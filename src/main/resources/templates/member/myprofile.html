<!DOCTYPE html>
<html
        lang="en" xmlns:sec="http://www.w3.org/1999/xhtml"
        xmlns:th="http://www.thymeleaf.org"
>
<head>
    <meta charset="UTF-8">
    <title>세이프라이드: 안전한 라이딩의 시작</title>
    <!-- teamplate : viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!--  template : CSS파일 적용-->
    <link href="/css/app.css" rel="stylesheet">
    <!--  template : 폰트-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum:wght@300;400;600&display=swap" rel="stylesheet">
    <!--  template : 부트스트랩, JS CDN-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"></script>
    <!--👇여기에 header script 넣어주시면 됩니다👇-->

    <style>
        #topInfo{
            height: 130px;
        }
        #riding-record {
            display: inline-block; /* 가로로 나열하기 위해 block레벨 요소를 inline-block레벨로 전환 */
            width: 33%; /* 영역 크기 지정 안해주면 inline 레벨처럼 내용물 만큼만 차지하기 때문에 크기 지정 */
            border: 2px solid aqua;
            background: orange;
        }
        #prifile-update {
            display: inline-block; /* 가로로 나열하기 위해 block레벨 요소를 inline-block레벨로 전환 */
            width: 50%; /* 영역 크기 지정 안해주면 inline 레벨처럼 내용물 만큼만 차지하기 때문에 크기 지정 */
            border: 2px solid aqua;
            background: orange;
        }
        #introduce{
            display: inline-block;
        }
        .badge-grade{
            width: 70px;
        }
        #chart{
            width: 800px;
            height: 400px;
        }
    </style>

    <!--👆여기에 header script 넣어주시면 됩니다👆-->
</head>
<body>
<div class="wrapper">
    <!-- 사이드 네비게이션바 (사이드바) -->
    <nav id="sidebar" class="sidebar js-sidebar">
        <div class="sidebar-content js-simplebar">
            <a class="sidebar-brand" href="/safe-ride">
                <span class="align-middle">SAFE RIDE</span>
            </a>


            <ul class="sidebar-header">
                <li class="sidebar-header">
                    Weather
                </li>

                <li class="sidebar-item">
                    <a class="sidebar-link" href="/weather">
                        <i class="align-middle" data-feather="sun"></i> <span class="align-middle"> 실시간 날씨</span>
                    </a>
                </li>

                <li class="sidebar-header">
                    Information
                </li>

                <li class="sidebar-item">
                    <a class="sidebar-link" href="/public-bicycle">
                        <i class="align-middle" data-feather="map-pin"></i> <span class="align-middle">공영자전거 현황</span>
                    </a>

                </li>

                <li class="sidebar-item">
                    <a class="sidebar-link" href="/safety-direction">
                        <i class="align-middle" data-feather="map"></i> <span class="align-middle">안전한 자전거 길 안내</span>
                    </a>
                </li>

                <li class="sidebar-header">
                    Community
                </li>

                <li class="sidebar-item">
                    <a class="sidebar-link" href="/article">
                        <i class="align-middle" data-feather="message-square"></i> <span class="align-middle">커뮤니티</span>
                    </a>
                </li>

                <li class="sidebar-item">
                    <a class="sidebar-link" href="/matching/list">
                        <i class="align-middle" data-feather="users"></i> <span class="align-middle">라이더 매칭</span>
                    </a>
                </li>

                <li class="sidebar-nav">
                <li class="sidebar-header">
                    My Page
                </li>

                <!-- TODO : 추후 삭제 -->
                <li class="sidebar-item">
                    <a class="sidebar-link" href="/safe-ride/login">
                        <i class="align-middle" data-feather="log-in"></i> <span class="align-middle">로그인</span>
                    </a>
                </li>

                <!-- TODO : 추후 삭제 -->
                <li class="sidebar-item">
                    <a class="sidebar-link" href="/safe-ride/join">
                        <i class="align-middle" data-feather="user-plus"></i> <span class="align-middle">회원가입</span>
                    </a>
                </li>

                <li class="sidebar-item">
                    <a class="sidebar-link" href="/safe-ride/myprofile">
                        <i class="align-middle" data-feather="user"></i> <span class="align-middle">마이페이지</span>
                    </a>
                </li>
            </ul>

            <!-- TODO 마이페이지 OR 라이딩 기록페이지 -->

            <div class="sidebar-cta">
                <div class="sidebar-cta-content">
                    <strong class="d-inline-block mb-2"> Safety & Healthy</strong>
                    <div class="mb-3 text-sm">
                        안전하게 달리셨나요? 오늘의 라이딩을 기록해보세요!
                    </div>
                    <div class="d-grid">
                        <a href="/safe-ride/myprofile" class="btn btn-primary">기록하기</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <div class="main">
        <nav class="navbar navbar-expand navbar-light navbar-bg">
            <a class="sidebar-toggle js-sidebar-toggle">
                <i class="hamburger align-self-center"></i>
            </a>

            <div class="navbar-collapse collapse">
                <ul class="navbar-nav navbar-align">
                    <li class="nav-item dropdown">
                        <a class="nav-icon dropdown-toggle d-inline-block d-sm-none" href="#" data-bs-toggle="dropdown">
                            <i class="align-middle" data-feather="settings"></i>
                        </a>

                        <a class="nav-link dropdown-toggle d-none d-sm-inline-block" href="#" data-bs-toggle="dropdown">
                            <img src="img/avatars/avatar.jpg" class="avatar img-fluid rounded me-1" alt="Charles Hall"/> <span
                                class="text-dark">Charles Hall</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end">
                            <a class="dropdown-item" href="pages-profile.html"><i class="align-middle me-1" data-feather="user"></i>
                                Profile</a>
                            <a class="dropdown-item" href="#"><i class="align-middle me-1" data-feather="pie-chart"></i>
                                Analytics</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="index.html"><i class="align-middle me-1" data-feather="settings"></i>
                                Settings & Privacy</a>
                            <a class="dropdown-item" href="#"><i class="align-middle me-1" data-feather="help-circle"></i> Help
                                Center</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">Log out</a>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="main">
            <main class="content">
                <!--👇여기에 내용 넣어주시면 됩니다👇-->
                <div class="container mt-4">
                    <div id="topInfo">
                        <h1 id="introduce">반갑습니다, <span sec:authentication="name"></span>님!</h1>
                        <span th:if="${#strings.equals(badges.getGrade(), 'QUICK_BOARD')}">
                        <img class="badge-grade" src="/img/badge/kickboard.png" >
                        </span>
                        <span th:if="${#strings.equals(badges.getGrade(), 'BYCICLE')}">
                            <img class="badge-grade" src="/img/badge/bicycle.png">
                        </span>
                        <span th:if="${#strings.equals(badges.getGrade(), 'SCOOTER')}">
                            <img class="badge-grade" src="/img/badge/scooter.png">
                        </span>
                        <span th:if="${#strings.equals(badges.getGrade(), 'MOTOR_CYCLE')}">
                            <img class="badge-grade" src="/img/badge/motorcycle.png">
                        </span>
                    </div>
                    <div id="container">
                        <!--라이딩 기록-->
                        <div id="riding-record">
                            <h2>라이딩 기록</h2>
                            <!--라이딩 기록이 없을 떄-->
                            <div th:if="${#strings.isEmpty(ridingRecord.getTotalRecord())}">
                                <h3>기록이 아직 없습니다!</h3>
                            </div>
                            <!--라이딩 기록이 존재한다면-->
                            <div th:unless="${#strings.isEmpty(ridingRecord.getTotalRecord())}">
                                <div id="total-record">
                                    <h3>총 기록</h3>
                                    <span>[[${ridingRecord.getTotalRecord()}]]km 탔어요! :)</span>
                                </div>
                                <div id="weekly-record">
                                    <h3>주간 기록</h3>
                                    <span>[[${ridingRecord.getWeeklyRecord()}]]km 탔어요! :)</span>
                                </div>
                                <!--오늘자 기록이 없을 떄-->
                                <div th:if="${#strings.isEmpty(ridingRecord.getTodayRecord())}">
                                    <h4>오늘 기록이 아직 없습니다! 열심히 달려봐요! :)</h4>
                                </div>
                                <div th:unless="${#strings.isEmpty(ridingRecord.getTodayRecord())}">
                                    <h3>오늘 기록</h3>
                                    <span>[[${ridingRecord.getTodayRecord()}]]km 탔어요! :)</span>
                                </div>
                            </div>
                            <form action="/safe-ride/myprofile/create-today" method="post">
                                <input id="today-record-input" name="todayRecord" type="number" required placeholder="오늘 기록을 입력">
                                <input type="submit" value="입력">
                            </form>
                        </div>
                        <div id="chart">
                            <canvas id="bar-chart"></canvas>
                        </div>
                        <!--        <div id="matching-record">-->
                        <!--            <h3>매칭기록</h3>-->
                        <!--            <table class="table">-->
                        <!--                <thead>-->
                        <!--                <tr>-->
                        <!--                    <th scope="col">매칭 신청자 ID</th>-->
                        <!--                    <th scope="col">평가 점수</th>-->
                        <!--                    <th scope="col">리뷰 코멘트</th>-->
                        <!--                    <th scope="col">리뷰 작성자 ID</th>-->
                        <!--                    <th scope="col">리뷰 받은 사람 ID</th>-->
                        <!--                </tr>-->
                        <!--                </thead>-->
                        <!--                <tbody th:if="${ridingRecord.getManner().id == null}">-->
                        <!--                    <tr>-->
                        <!--                        &lt;!&ndash;Matching&ndash;&gt;-->
                        <!--                        <th scope="col" th:text="데이터없음"></th>-->
                        <!--                    </tr>-->
                        <!--                </tbody>-->
                        <!--                <tbody th:unless="${ridingRecord.getManner().id == null}">-->
                        <!--                <tr>-->
                        <!--                    &lt;!&ndash;Matching&ndash;&gt;-->
                        <!--                    <th scope="col" th:text="사용자1"></th>-->
                        <!--                    <th scope="col" th:text="별다섯개"></th>-->
                        <!--                    <th scope="col" th:text="재밌었습니다"></th>-->
                        <!--                    <th scope="col" th:text="사용자1"></th>-->
                        <!--                    <th scope="col" th:text="사용자2"></th>-->
                        <!--                </tr>-->
                        <!--                </tbody>-->
                        <!--            </table>-->
                        <!--        </div>-->

                        <!--프로필 수정-->
                        <div id="prifile-update">
                            <h2>프로필 수정</h2>
                            <form action="/safe-ride/myprofile/update" method="post">
                                <div>
                                    <label for="password">비밀번호</label>
                                    <input id="password" name="password" type="password" placeholder="비밀번호 재설정">
                                </div>
                                <div>
                                    <label for="passwordCk">비밀번호</label>
                                    <input id="passwordCk" name="passwordCk" type="password" placeholder="비밀번호 재설정 확인">
                                </div>
                                <div>
                                    <label for="email">이메일</label>
                                    <input id="email" name="email" type="text" th:value="${member.email}">
                                </div>
                                <div>
                                    <label for="nickName">닉네임</label>
                                    <input id="nickName" name="nickName" type="text" th:value="${member.nickname}">
                                </div>
                                <div>
                                    <label for="phoneNumber">전화번호</label>
                                    <input id="phoneNumber" name="phoneNumber" type="number" th:value="${member.getPhoneNumber()}">
                                </div>
                                <div>
                                    <label for="birthday">생년월일</label>
                                    <input id="birthday" name="birthday" type="number" th:value="${member.getBirthday()}">
                                </div>
                                <div>
                                    <input type="submit" value="수정하기">
                                </div>
                            </form>
                        </div>
                    </div>
                    <form action="/safe-ride/logout">
                        <input type="submit" value="로그아웃">
                    </form>

                    <a href="/safe-ride">홈으로</a>

                </div>
                <!-- 👆 여기에 내용 넣어주시면 됩니다 👆-->
            </main>

            <footer class="footer">
                <div class="container-fluid">
                    <div class="row text-muted">
                        <div class="col-6 text-start">
                            <p class="mb-0">
                                <a class="text-muted"
                                   href="https://img.animalplanet.co.kr/news/2019/08/10/700/2w4w02ks9531p3v874c7.jpg"
                                   target="_blank"><strong>Team6 라이더스</strong></a>
                            </p>
                        </div>
                        <div class="col-6 text-end">
                            <ul class="list-inline">
                                <li class="list-inline-item">
                                    <a class="text-muted" href="https://github.com/soeunc/safe_ride" target="_blank">Github</a>
                                </li>
                                <li class="list-inline-item">
                                    <a class="text-muted" href="https://www.notion.so/likelion/6-1cc32ef7fbbc4332b81f959fe6d153db"
                                       target="_blank">Notion</a>
                                </li>
                                <li class="list-inline-item">
                                    <a class="text-muted"
                                       href="https://docs.google.com/spreadsheets/d/1GipYE2oyzrQxeagBfsVn9E8ZU_aX-j0JmuzPyywan3k/edit#gid=50422208"
                                       target="_blank">Google sheet</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
</div>
</body>

<!--👇여기에 사용하는 script 넣어주시면 됩니다👇-->
<!--chart.js-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script th:inline="javascript">

    window.onload = function () {
        //alert
        const alertMsg = [[${msg}]];

        if (alertMsg){
            alert(alertMsg);
        }
    }
    const thisWeek = [[${ridingRecord.thisWeek}]];
    const weeklyRecordList = [[${ridingRecord.weeklyRecordList}]];
    new Chart(document.getElementById("bar-chart"), {
        type: 'bar',
        data: {
            labels: [
                thisWeek.at(0),
                thisWeek.at(1),
                thisWeek.at(2),
                thisWeek.at(3),
                thisWeek.at(4),
                thisWeek.at(5),
                thisWeek.at(6)],
            datasets: [
                {
                    label: "Population (millions)",
                    backgroundColor: ["#ff0000", "#ff7f27","#ffd900","#00db07","#00b7ff","#3700dc","#a600ff"],
                    data: [
                        weeklyRecordList.at(0),
                        weeklyRecordList.at(1),
                        weeklyRecordList.at(2),
                        weeklyRecordList.at(3),
                        weeklyRecordList.at(4),
                        weeklyRecordList.at(5),
                        weeklyRecordList.at(6),
                    ]
                }
            ]
        },
        options: {
            legend: { display: false },
            title: {
                display: true,
                text: '주간 라이딩 기록'
            }
        }
    });
</script>
<!--👆여기에 사용하는 script 넣어주시면 됩니다👆-->
<script src="/js/app.js"></script> <!-- template -->
</html>